import{K as u,a as s,b as c,l as d,sa as n}from"./chunk-CJOGYO37.js";var h=(()=>{class i{addToCart(t){this.cartItemsSignal.update(a=>a.find(r=>r.product.id===t.id)?a.map(r=>r.product.id===t.id?c(s({},r),{quantity:r.quantity+1}):r):[...a,{product:t,quantity:1}]),this.saveToStorage()}addToCartLegacy(t){this.cartItemsSignal.update(a=>{if(a.find(e=>e.product.id===t.id))return a.map(e=>e.product.id===t.id?c(s({},e),{quantity:e.quantity+1}):e);let r={id:t.id,name:t.name,price:t.price,image:t.image,rating:0,reviews:0,categoryId:0};return[...a,{product:r,quantity:1}]}),this.saveToStorage()}removeFromCart(t){this.cartItemsSignal.update(a=>a.filter(o=>o.product.id!==t)),this.saveToStorage()}updateQuantity(t,a){if(a<=0){this.removeFromCart(t);return}this.cartItemsSignal.update(o=>o.map(r=>r.product.id===t?c(s({},r),{quantity:a}):r)),this.saveToStorage()}clearCart(){this.cartItemsSignal.set([]),this.saveToStorage()}saveToStorage(){try{localStorage.setItem("cart",JSON.stringify(this.cartItemsSignal()))}catch{console.warn("Could not save cart to storage")}}loadFromStorage(){try{let t=localStorage.getItem("cart");t&&this.cartItemsSignal.set(JSON.parse(t))}catch{console.warn("Could not load cart from storage")}}constructor(){this.cartItemsSignal=u([]),this.cartItems=this.cartItemsSignal.asReadonly(),this.cartCount=n(()=>this.cartItemsSignal().reduce((t,a)=>t+a.quantity,0)),this.subtotal=n(()=>this.cartItemsSignal().reduce((t,a)=>t+a.product.price*a.quantity,0)),this.items=n(()=>this.cartItemsSignal().map(t=>({id:t.product.id,name:t.product.name,price:t.product.price,image:t.product.image,quantity:t.quantity}))),this.loadFromStorage()}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275prov=d({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{h as a};
